---
title: 'Assignment 4: Exploratory report on juvenile snowshoe hares in Bonanza Creek
  Experimental Forest'
author: "Mia Guarnieri"
date: "11/7/2021"
output: 
  html_document: 
    number_sections: yes
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(here)
library(lubridate)
library(dplyr)
library(effsize)
library(kableExtra)
```

# Introduction

A 4 - 5 sentence "mini-introduction" to what this study is exploring, including basic background information about the subject, site and study (with citations as needed), and a brief overview of what is included in the exploratory report. You should probably do this last so you know whatâ€™s contained in the report.

# Data and analyses

A 3 - 4 sentence section in which you briefly describe the data, including citation & credit as needed, and provide an overview of the main analysis, statistical methods and tools used.

# Juvenile hare initial investigation

## Annual juvenile hare trap counts 

Count the total number of juvenile hare trappings during each year of the study, and create a finalized data visualization of the counts by year. Include a figure caption below the figure in your report. 

```{r}
#read in the hare data
bonanza_hares <- read.csv(here("Data", "bonanza_hares.csv"))

#create a dataframe with only juvenile hare counts

juv_hares_year <- bonanza_hares %>% 
  filter(age == "j") %>% #keeping only observations for juvenile hares
  mutate(date = mdy(date), #change date column to have class "Date"
         year = year(date)) %>% #add a new column named "year" with just the observation years
 group_by(year) #telling R to group the data by year

#visualize this data with a bar graph

ggplot(data = juv_hares_year, aes(x = year)) +
  geom_bar() +
  labs(x = "Year",
       y = "Juvenile Hares Observed") +
  scale_x_continuous(breaks = seq(from = 1999, to = 2021, by = 1)) +
  theme(axis.text.x = element_text(angle = 90))

#make a new object containing only counts of juvenile hares by year
juv_hares_annual_count <- juv_hares_year %>% 
  count(year)
```

**Figure 1:** The total number of juvenile snowshoe hares observed each year at the Bonanza Creek Long Term Ecological Research site between 1999 and 2012.

### Takeaway

The maximum number of juvenile hares trapped in one year during this period was `r max(juv_hares_annual_count$n)` during `r juv_hares_annual_count[juv_hares_annual_count$n == max(juv_hares_annual_count$n), ]$year`, and the minimum number of juvenile hares trapped in one year was 0 during 2002 and 2009. The mean number of juvenile hares trapped per year is `r mean(juv_hares_annual_count$n)`, and the median is `r median(juv_hares_annual_count$n)`. The annual number of juvenile hares trapped generally decreased per year, particularly between 1999 and 2000. It is important to note than sampling effort can have an impact on the apparent number of trapped individuals. In future analyses, to ensure that data trends are a result of trends in the populations, sampling effort should be standardized between years (i.e., an equal number of traps should be set, for an equal number of days).


## Visualizing juvenile hare weights

Create a finalized data visualization (or visualizations) in which you compare **juvenile hare weights by sex and site (grid)** (ignore other variables). You should include groups where these variables are not recorded (`NA`). Include finalized figure captions below your visualization(s).

```{r}
#formatting the data so labels show up appropriately in graph
juv_hares_boxplot_data <- juv_hares_year %>% 
  group_by(sex, grid) %>% 
  mutate(sex = case_when(
    sex %in% "f" ~ "Female",
    sex %in% "m" ~ "Male",
    sex %in% NA ~ "Unknown")) %>% 
  mutate(grid = case_when(
    grid %in% "bonbs" ~ "Bonanza Black Spruce",
    grid %in% "bonmat" ~ "Bonanza Mature",
    grid %in% "bonrip" ~ "Bonanza Riparian"))

#make a boxplot of juvenile hare weights by site, with scatterplot points mapped to it
ggplot(data = juv_hares_boxplot_data, aes(x = sex, y = weight, fill = sex)) +
  scale_fill_manual(values = c("mistyrose", "lightsteelblue", "lightgrey")) +
  geom_boxplot(outlier.color = "black") +
  geom_point(shape = 1, alpha = 0.8, aes(color = sex)) +
  scale_color_manual(values = c("palevioletred", "steelblue", "gray42")) +
  facet_wrap(~grid) +
  labs(y = "Body weight (g)",
       x = "Sex")

```
**Figure 2:** Body weight of juvenile snowshoe hares observed at the Bonanza Creek Long Term Ecological Research site between 1999 and 2012, grouped by sex and by observation site.

```{r}
#make a summary table with juvenile hare weights by sex and site

juv_hares_sex_site_table <- juv_hares_year %>% 
  group_by(sex, grid) %>% 
  summarize(Mean = mean(weight),
            Median = median(weight),
            Standard_Deviation = sd(weight),
            Count = n())
```



